{% extends "main/base.html" %}

{% block title %}Home | ANUMC{% endblock %}

{% block content %}
<h1 class="title">Welcome to the ANU Mountaineering Club!</h1>
<p class="subtitle">The largest and most active outdoors club in Canberra! We welcome adults who are keen on outdoor adventures from climbing to kayaking and everything in between.</p>

{% if announcements %}
<div class="notification is-warning">
    <h2 class="title is-4">Important Notice</h2>
    {% for ann in announcements %}
        <h3 class="title is-5">{{ ann.title }}</h3>
        {#
          Use the ``safe`` filter after ``linebreaks`` so that characters like
          apostrophes are rendered as-is instead of being HTML-escaped to
          entities such as &#x27;. The announcement content is editorial
          content managed through the admin, so marking it safe here maintains
          fidelity to the source text.  Without ``safe``, Django will escape
          the apostrophe which caused our TDD test to fail.
        #}
        <p>{{ ann.body|linebreaks|safe }}</p>
    {% endfor %}
</div>
{% endif %}

<h2 class="title is-4">Upcoming Trips and Events!</h2>
<div class="columns is-multiline">
    {% for event in events %}
    <div class="column is-one-third">
        <div class="card">
            {% if event.image %}
            <div class="card-image">
                <figure class="image is-4by3">
                    <img src="{{ event.image.url }}" alt="{{ event.title }}">
                </figure>
            </div>
            {% endif %}
            <div class="card-content">
                <p class="title is-5">{{ event.title }}</p>
                <p class="subtitle is-6">{{ event.start_datetime|date:"M. j, Y" }} â€” {{ event.end_datetime|date:"M. j, Y" }}</p>
                {% if event.fitness_required %}
                    <p><strong>Fitness:</strong> {{ event.fitness_required }}</p>
                {% endif %}
                {% if event.experience_required %}
                    <p><strong>Experience:</strong> {{ event.experience_required }}</p>
                {% endif %}
                <p>{{ event.description|truncatewords:25 }}</p>
            </div>
            <footer class="card-footer">
                <a href="{{ event.get_absolute_url }}" class="card-footer-item">View</a>
                {% if event.is_full %}
                    <span class="card-footer-item has-text-danger">Full</span>
                {% elif event.spots_total > 0 %}
                    <span class="card-footer-item">{{ event.spots_available }} / {{ event.spots_total }} spots left</span>
                {% endif %}
            </footer>
        </div>
    </div>
    {% empty %}
    <p>No upcoming events at this time. Check back later!</p>
    {% endfor %}
</div>
{% endblock %}